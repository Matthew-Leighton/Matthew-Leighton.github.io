---
layout: post
title: "Diffusion: Part 1"
date: 2020-01-20
---

<style TYPE="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
    }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML-full"></script>


What is diffusion? 

Let's start by looking at a finite (discrete) problem in one dimension. 

Consider $N$ particles located at position $x=0$ on an infinite $1$-$D$ line. These could be, for example, proteins sitting in a microtubule. We want to answer the question of how these particles spread out in time. Let $x_i(n)$ be the position of the $i^\text{th}$ particle after $n$ steps. We will assume that each particle moves a distance $\delta$ in either the positive or negative direction (each with probability $50\%$) at each timestep, and we use disrete time steps $\Delta t$. Thus, at time $t = n\Delta t$, each particle will have taken $n$ steps of $\pm \delta$. We can describe these dynamics with a difference equation:
\begin{equation}
x_i(n) = x_i(n+1)\pm \delta.
\end{equation}

With this simple discrete model of 1-D diffusion, we can begin to track some interesting particle statistics, namely the mean and variance of $x(n)$.

#### Calculating the mean particle displacement
The mean of $x(n)$ is defined as 
\begin{equation}
\begin{aligned}
\langle x(n)\rangle &  = \frac{1}{N} \sum_{i=1}^Nx_i(n)\\\
& = \frac{1}{N}\sum_{i=1}^N (x_i(n+1)\pm \delta) \\\
& = \frac{1}{N}\sum_{i=1}^N x_i(n+1) + \frac{1}{N}\sum_{i=1}^N \pm \delta \\\
& = \langle x(n-1)\rangle.
\end{aligned}
\end{equation}

In the above calculation we used the difference equation defined earlier, and made use of the fact that the particles hop in both directions with equal probability to get $\frac{1}{N}\sum_{i=1}^N \pm \delta = 0$ [^1]. Now, notice that we have a fully recursive definition for $\langle x(n)\rangle$. Since we already assumed that $x(0)=0$ for every particle, that means $\langle x(0)\rangle=0$ and thus $\langle x(n)\rangle=0$ for every $n$. Physically, this tells us that the distribution of particle positions will always be centered at $x=0$.


#### Calculating the mean-squared particle displacement
Naturally, the next thing we might want to calculate about the distribution of particle positions is the standard deviation, $\sigma$ (or the variance, $\sigma^2$). The variance of a distribution $x$ is defined as the difference between the mean of $x^2$ and the square of the mean of $x$. In equation form[^2]:
\begin{equation}
\sigma^2 = \langle x^2 \rangle - \langle x \rangle^2.
\end{equation}

To compute the variance, we will need the mean-squared displacement, $\langle x^2\rangle$. We calculate this by again using the difference equation for $x_i(n)$ we defined earlier:
\begin{equation}
\begin{aligned}
\langle x^2 \rangle & = \frac{1}{N}\sum_{i=1}^N x_i^2 \\\
& =\frac{1}{N}\sum_{i=1}^N [x_i(n-1)\pm\delta][x_i(n-1)\pm\delta]\\\
& = \frac{1}{N}\sum_{i=1}^N\left[ x_i(n-1)^2 \pm 2\delta x(n-1) + \delta^2 \right]\\\
& = \langle x(n-1)^2\rangle + \delta^2.
\end{aligned}
\end{equation}
This gives us a fully defined recurrence relation for the mean-squared displacement. Since $x_i(0)=0$ for each particle, we know $\langle x^2(0)\rangle=0$. Then clearly $\langle x^2(1)\rangle=\delta^2$, $\langle x^2(2)\rangle=2\delta^2$, etc... In general we have $\langle x^2(n)\rangle = n\delta^2$. We can now convert back from counts of timesteps $n$ into units of time $t = n\Delta t$. This gives us
\begin{equation}
\langle x^2(t)\rangle = \frac{\delta^2}{\Delta t}t.
\end{equation}
As is commonly done, we can define $D=\frac{\delta^2}{2\Delta t}$ to be the diffusion constant, measured in m$^2$/s (the factor of 1/2 is there primarily for historical reasons). From our definition of the variance above, keeping in mind that $\langle x(t)\rangle$=0 for all t, we finally have
\begin{equation}
\sigma^2(t) = 2Dt.
\end{equation}
A key takeaway from this result is that the standard deviation of the particle position distribution is $\sqrt{2Dt}$. This means that the particles spread out with $\sqrt{t}$. We can contrast this with particles in balistic motion, whose displacement scales with $t$, or particles subject to a constant net force, whose displacement scales with $t^2$.

#### Binomial Distribution
Thus far we have computed a couple statistics of our diffusing particles, but to fully understand this system we need to determine the full distribution for $x(n)$.


[^1]: You might notice that this claim $\left(\frac{1}{N}\sum_{i=1}^N \pm \delta = 0\right)$ is not technically true. To make this calculation fully rigorous, it is necessary to consider the limit as $N\rightarrow\infty$.

[^2]: Note that this quantity is always greater than 0. This can be shown using [Jensen's Inequality.](https://en.wikipedia.org/wiki/Jensen%27s_inequality)
